## Garbage Collection (GC)

### Garbage Collection(가비지 컬렉션)이란?

가비지 컬렉션은 JVM의 메모리 관리 기법 중 하나로 시스템에서 동적으로 할당됐던 메모리 영역 중에서 필요없어진 메모리 영역을 회수하여 메모리를 관리해주는 기법이다.

프로그램을 개발 하다 보면 유효하지 않은 메모리인 가바지(Garbage)가 발생하게 된다. 
C언어를 이용하면 free()라는 함수를 통해 직접 메모리를 해제해주어야 한다. 
하지만 Java나 Kotlin을 이용해 개발을 하다 보면 개발자가 메모리를 직접 해제해주는 일이 없다. 
그 이유는 JVM의 가비지 컬렉터가 불필요한 메모리를 알아서 정리해주기 때문이다. 
대신 Java에서 명시적으로 불필요한 데이터를 표현하기 위해서 일반적으로 null을 선언해준다. 
예를 들어 아래와 같은 코드가 있다고 가정하자

```
Person person = new Person();
person.setName("Hyun");
person = null; // 가비지 발생
person = new Person();
person.setName("Hee");
```

기존의 Hyun으로 생성된 person 객체는 더이상 참조를 하지 않고 사용이 되지 않아서 Garbage(가비지)가 되었다. 
Java나 Kotlin에서는 이러한 메모리 누수를 방지하기 위해 가비지 컬렉터(Garbage Collector, GC)가 주기적으로 검사하여 메모리를 청소해준다.


### 장점

1. 이미 해제된 메모리에 접근하는 버그를 방지해준다.
2. 이미 해제된 메모리를 또다시 해제하는 버그를 방지해준다.
3. 메모리 누수를 방지한다.


### 단점

1. 메모리가 해제되는 시점을 알 수가 없다.
2. 해제할 메모리를 결정하는데 비용이 든다.
3. 쓰레기 수집이 이루어지는 시점을 예측할 수가 없어서, 어떤 타이밍에 점유당할지 모른다.


### 가지비 컬렉션 작업 과정

GC의 작업을 수행하기 위해 JVM이 어플리케이션의 실행을 잠시 멈추고, GC를 실행하는 쓰레드를 제외한 모든 쓰레드들의 작업을 중단 후 (Stop-the-world 과정) 사용하지 않는 메모리를 제거(Mark and Sweep 과정)하고 작업이 재개된다.


### Stop-the-world란?

가비지 컬렉터가 가비지들을 회수하는 동작이 별도의 스레드에서  조용히 수행되면 큰 문제는 없다.
하지만 가비지 컬렉터는 종종 가비지들이 메모리 공간을 회수하기위해 자바 애플리케이션의 실행을 멈춘다.
이런 동작을 Stop-the-world라고한다. 경우에 따라 몇 초간 동작이 멈추는 것이 곤란 할 수 있으므로
Stop-the-wolrd 시간을 어느정도로 허용할 것인지는 실행할 애플리케이션의 특성에 따라 다르다.
대부분 JVM에서 GC 튜닝이라고 하면 이 시간을 줄이는 것을 의미한다.


## 출처
https://dev-coco.tistory.com/153
