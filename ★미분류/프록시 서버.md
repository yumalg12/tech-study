## 프록시 서버란?

프록시 서버 (proxy server)는 클라이언트와 원격 서버 간의 중개자로 작용하는 중간 서버 시스템이나 소프트웨어를 가리킨다.

서버와 클라이언트 사이에 중계기로서 대리로 통신을 수행하는 것을 가리켜 '프록시', 그 중계 기능을 하는 것을 프록시 서버라고 부른다.[1]

클라이언트가 외부 서버에 직접적으로 접속하는 대신 프록시 서버를 경유하여 간접적으로 통신하게 된다. 이를 통해 프록시 서버는 클라이언트의 IP 주소를 가리고, 네트워크 트래픽을 관리하고 보안 정책을 적용하는 등의 역할을 수행한다.

인터넷을 통한 모든 통신은 데이터 패킷을 통해 이루어진다. 클라이언트가 서버의 IP 주소를 사용하여 서버에 데이터를 요청하면, 서버는 해당 클라이언트의 IP 주소로 응답을 전송한다.<br>
직접 네트워크 연결에서는 클라이언트와 서버가 서로의 IP 주소를 알고 있다. 그러나 프록시 서버를 사용하면 클라이언트와 서버 사이에 프록시 서버라는 중간 단계가 추가된다.<br>
이로 인해 프록시 서버는 클라이언트와 서버 간의 직접적인 연결을 가리며, 트래픽 소스를 익명화하여 클라이언트의 정보를 숨길 수 있다. 또한, 보안 정책을 준수하기 위해 데이터를 검사하거나 필터링할 수 있다.

프록시 서버는 정방향 프록시와 역방향 프록시로 나뉜다.

정방향 프록시 (forward proxy)는 클라이언트 측에서 설정되어 서버에 대한 요청을 중계하는 반면, 역방향 프록시 (reverse proxy)는 서버 측에서 설정되어 서버로 들어오는 요청을 중계한다. 
이때 정방향 프록시는 역방향 프록시보다 먼저 작동된다.

이 방법의 작동 원리는 다음과 같다.[2,3]

<br>

### 정방향 프록시 서버

정방향 프록시는 클라이언트 대신 프록시 서버가 목적 서버에 통신해주는 구성이다.

프록시를 사용하지 않으면 다음과 같이 통신한다.

|클라이언트<br>IP: 100.000.0.0|http://example.com에 접속<br>─────────────────▶|Web 서버<br>[액세스 로그] 100.0.0에서 액세스가 있었다<br>http://example.com|
|---|---|---|

반면, 정방향 프록시의 경우 다음과 같이 프록시 서버가 외부 Web 서버와 통신을 하므로 클라이언트는 프록시 서버만을 통해 정보를 얻게 된다. 따라서 Web 서버쪽에서는 프록시 서버를 통한 액세스 로그가 남는다.

|클라이언트<br>IP: 100.000.0.0|http://200.000.0.0에 접속<br>─────────────────▶<br>◀─────────────────<br>페이지 반환|프록시 서버<br>IP: 200.000.0.0|http://example.com에 접속<br>─────────────────▶<br>◀─────────────────<br>페이지 반환|Web 서버<br>[액세스 로그] 200.0.0에서 액세스가 있었다<br>http://example.com|
|---|---|---|---|---|

<br>

**정방향 프록시의 특징 및 장점**은 다음과 같다.

- **캐시 저장 (액세스 고속화)**: 프록시 서버에 캐시를 저장할 수 있다. 다시 동일한 페이지를 리퀘스트하면 캐시에 남아 있는 정보를 클라이언트에게 전달하므로 사이트 접속 속도가 빨라진다.
- **URL 필터링**: 외부 액세스는 프록시 서버를 경유하도록 되어 있으므로 모든 사용자의 액세스를 필터링할 수 있다. 예를 들어, http://example2.com만 허용한다면 http://example.com으로 들어온 액세스는 리퀘스트를 차단한다.

<br>

### 역방향 프록시 서버

역방향 프록시는 애플리케이션을 호스팅하는 서버와 최종 사용자 간의 중간 서버이다. 역방향 프록시는 Web 서버 쪽에 위치하여 클라이언트의 접근을 최초로 받아 리퀘스트에 해당하는 Web 서버에 배분해주는 역할을 한다.

다음과 같이 통신이 이루어진다.

<table>
  <tr>
    <td rowspan=3>클라이언트<br>IP: 100.000.0.0</td>
    <td>http://example.com/A에 접근</td>
    <td rowspan=3>프록시 서버<br>[설정] /A 액세스 -> IP: 200.000.0.0을 리퀘스트<br> /B 액세스 -> IP: 300.000.0.0을 리퀘스트<br>http://example.com</td>
    <td>──▶</td>
    <td>Web 서버<br>/A용 정보를 반환<br>IP: 200.000.0.0</td>
  </tr>
  <tr>
    <td>─────────────────▶</td>
    <td></td><td></td>
  </tr>
  <tr>
    <td>http://example.com/B에 접근</td>
    <td>──▶</td>
    <td>Web 서버<br>/B용 정보를 반환<br>IP: 300.000.0.0</td>
  </tr>
</table>

클라이언트는 프록시 서버를 통해 간접적으로 웹 서버에 액세스하고 있다. 프록시 서버에서는 특정 URL 패턴에 따라 요청을 받을 수 있는 여러 웹 서버들 사이에서 요청을 분배하거나, 특정 URL에 대한 요청을 특정 웹 서버로 라우팅하도록 설정되어 있다.

<br>

**역방향 프록시의 특징 및 장점**은 다음과 같다.

- **구조 은폐**: 클라이언트의 입장에서는 프록시 서버가 Web 서버와 같은 동작을 하므로 Web 서버가 여러 개 존재하는 것을 은폐할 수 있다.

- **부담 분산 (Load Balancing)**: 역방향 프록시는 클라이언트의 요청을 여러 대의 웹 서버로 각각 전달함으로써 서버에 가해질 부하를 분산시킬 수 있다. 로드 밸런싱 (load balancing)*과 결합하면, 서버 간 부하를 균등하게 분산하여 전체적인 성능을 향상시킬 수 있다.
```
*로드 밸런싱: 컴퓨터 네트워크 기술의 일종으로, 둘 이상의 중앙처리장치 혹은 저장장치와 같은 컴퓨터 자원에 작업을 나누는 것을 의미한다.[4]
```

- **캐시 기능**: 정방향 프록시와 마찬가지로, 클라이언트가 동일한 데이터를 요청할 때 프록시 서버가 이미 저장해둔 데이터를 반환하여 빠른 응답을 제공할 수 있다.

- **보안 및 바이러스 대응**: 모든 통신이 역방향 프록시로 집중되므로, 프록시 서버 내에 보안 대책과 바이러스 대응을 구현해 두면 웹 서버로의 부정 액세스나 악성 사용자로부터 시스템을 보호할 수 있다. 보안 정책을 프록시 서버에서 통합하여 관리하므로 보다 안전한 환경을 제공할 수 있다.

<br>

##
[1] https://ko.wikipedia.org/wiki/%ED%94%84%EB%A1%9D%EC%8B%9C_%EC%84%9C%EB%B2%84<br>
[2] https://aws.amazon.com/ko/compare/the-difference-between-proxy-and-vpn/<br>
[3] https://engineer-mole.tistory.com/288<br>
[4] https://ko.wikipedia.org/wiki/%EB%B6%80%ED%95%98%EB%B6%84%EC%82%B0<br>
