# 트랜잭션(Transaction)

**데이터베이스의 상태를 변화시키기 위해 수행하는 작업의 논리적 단위**

> 데이터베이스의 상태를 변화시킨다 : SELECT, INSERT, UPDATE, DELETE 등과 같은 조작어를 사용하는 행동을 의미

<br><br>

### 트랜잭션의 특징
1. 트랜잭션은 데이터베이스 시스템에서 병행 제어 및 회복 작업 처리 시 처리되는 작업의 논리적 단위이다.

2. 사용자가 시스템에 대한 서비스 요구시 시스템이 응답하기 위한 상태 변환 과정의 작업단위이다.
3. 하나의 트랜잭션은 COMMIT 되거나 ROLLBACK 된다.

```
COMMIT : 모든 부분 작업이 정상적으로 완료되면 이 변경사항을 한꺼번에 DB에 반영한다.
ROLLBACK : 부분 작업이 실패하면 트랜잭션 실행 전으로 되돌린다.
```

<br>

### 트랜잭션의 성질 (ACID 특성)
1. **원자성(Atomicity)**

    - 트랜잭션이 데이터베이스에 모두 반영되든지 아니면 전혀 반영되지 않아야 한다는 것이다.

    - 트랜잭션 내의 모든 명령은 반드시 완벽히 수행되어야 하며, 모두가 완벽히 수행되지 않고 하나라도 오류가 발생하면 트랜잭션 전부 취소 되어야 한다.

<br>

2. **일관성(Consistency)**

    - 트랜잭션이 그 실행을 성공적으로 완료하면 언제나 일관성 있는 데이터베이스 상태를 유지해야 한다.

    - 시스템이 가지고 있는 고정요소는 트랜잭션 수행 전과 트랜잭션 수행 완료 후의 상태가 같아야 한다.

<br>

3. **독립성, 격리성 (Isolation)**

    - 둘 이상의 트랜잭션이 동시에 실행될 경우 어떤 하나의 트랜잭션이 다른 트랜잭션의 연산에 끼어들 수 없다.

    - 수행중인 트랜잭션이 완전히 완료될 때까지 다른 트랜잭션에서 수행 결과를 참조할 수 없다.

<br>

4. **영속석, 지속성 (Durability)**

    - 성공적으로 완료된 트랜잭션의 결과는 영구적으로 반영되어야 한다.

<br>

### 트랜잭션의 연산 및 상태
- **COMMIT 연산**

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 트랜잭션에 대한 작업이 성공적으로 끝났고 데이터베이스과 일관된 상태에 있을 때,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 이 트랜잭션이 행한 갱신 연산이 완료된 것을 트랜잭션 관리자에게 알려주는 연산

- **ROLLBACK 연산**

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 하나의 트랜잭션 처리가 비정상적으로 종료되어 데이터베이스의 일관성을 깨뜨렸을 때,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 이 트랜잭션의 일부가 정상적으로 처리되었더라도 트랜잭션의 원자성을 구현하기 위해 이 트랜잭션이 행한
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 모든 연산을 취소한다.

<br>

### 트랜잭션의 상태

![트랜잭션_상태전이도](https://itwiki.kr/images/1/1e/%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98_%EC%83%81%ED%83%9C%EC%A0%84%EC%9D%B4%EB%8F%84.png)


- **활동(Active)** : 트랜잭션이 실행 중인 상태

  <br>

- **부분 완료(Partially Committed)** : 트랜잭션의 마지막까지 실행되었지만, Commit 연산이 실행되기 직전 상태
- **완료(Committed)** : 트랜잭션이 성공적으로 종료되어 Commit 연산을 실행한 후의 상태

```
설계된 트랜잭션대로 명령을 성공적으로 수행하면 그 다음 상태는 부분적 완료(Partially Committed)상태가 된다.
설계된 작업대로 작업이 성공하였다고 하여 무조건 반영하는 것이 아니라, 설계자의 최종 승인(Commit)이 있을 때 까지 실제 데이터베이스에 작업 내용을 반영하지 않고 기다리고 있는 상태이다.
설계자가 작업 결과에 대하여 반영을 승인(Commit)한다면 트랜잭션이 성공적으로 종료된다(Committed)
```

<br>

- **실패(Failed)** : 트랜잭션 실행에 오류가 발생하여 중단된 상태
- **철회(Aborted)** : 트랜잭션이 비정상적으로 종료되어 Rollback 연산을 수행한 상태

<br>
<br>

<hr>


[출처]

- https://inpa.tistory.com/entry/MYSQL-%F0%9F%93%9A-%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98Transaction-%EC%9D%B4%EB%9E%80-%F0%9F%92%AF-%EC%A0%95%EB%A6%AC

- https://dev-coco.tistory.com/72

- https://itwiki.kr/w/%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98
